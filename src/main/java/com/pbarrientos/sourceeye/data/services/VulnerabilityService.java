package com.pbarrientos.sourceeye.data.services;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import com.pbarrientos.sourceeye.data.model.Vulnerability;
import com.pbarrientos.sourceeye.data.repositories.VulnerabilityRepository;
import com.pbarrientos.sourceeye.exceptions.SourceEyeServiceException;

/**
 * Service to handle transactions with vulnerability entities
 *
 * @author Pablo Barrientos
 */
@Service
@Transactional
public class VulnerabilityService extends BaseService<Vulnerability, String> {

    /**
     * The vulnerability spring data repository
     */
    @Autowired
    private VulnerabilityRepository repository;

    @Override
    public JpaRepository<Vulnerability, String> getRepository() {
        return this.repository;
    }

    /**
     * Return a vulnerability by its CVE
     *
     * @param cve the cve
     * @return a vulnerability
     * @throws SourceEyeServiceException in case there is any error
     * @since 0.1.0
     */
    public Vulnerability findByCve(final String cve) throws SourceEyeServiceException {
        return this.repository.findByCve(cve);
    }

    /**
     * Return a list of vulnerabilities that fits in the category defined by the CWE
     *
     * @param cwe the cwe
     * @return a list of vulnerabilities
     * @throws SourceEyeServiceException in case there is any error
     * @since 0.1.0
     */
    public List<Vulnerability> findByCwe(final String cwe) throws SourceEyeServiceException {
        return this.repository.findByCwe(cwe);
    }

}
